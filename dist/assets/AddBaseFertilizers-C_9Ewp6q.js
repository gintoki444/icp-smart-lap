import{u as C,r as i,j as e,R as y,C as l,B as x,y as g}from"./index-CMKGjvil.js";import{p as F}from"./baseFertilizersRequest-jsJdYFIk.js";import{C as c}from"./Card-ltuRbL1m.js";import{A as E}from"./Alert-CaEs9ZRl.js";import{F as r}from"./Form-XAT3KesX.js";import"./CloseButton-DXA2z1Sn.js";import"./Transition-CvY6YelV.js";import"./setPrototypeOf-DgZC2w_0.js";const A=()=>{const d=C(),[n,j]=i.useState({common_name_th:"",common_name_en:"",formula_code:"",description:""}),[a,h]=i.useState({}),[_,p]=i.useState(null),[m,u]=i.useState(!1),f=()=>{const o={};return n.common_name_th.trim()||(o.common_name_th="กรุณากรอกชื่อสามัญ (ภาษาไทย)"),n.common_name_en.trim()||(o.common_name_en="กรุณากรอกชื่อสามัญ (ภาษาอังกฤษ)"),n.formula_code.trim()||(o.formula_code="กรุณากรอกรหัสสูตรปุ๋ย"),n.description.trim()||(o.description="กรุณากรอกคำอธิบาย"),h(o),Object.keys(o).length===0},t=o=>{const{name:s,value:v}=o.target;j({...n,[s]:v}),h({...a,[s]:""})},b=async o=>{if(o.preventDefault(),!!f()){u(!0),p(null);try{if((await F(n)).base_fertilizer_id)g.success("เพิ่มปุ๋ยพื้นฐานสำเร็จ!",{autoClose:3e3}),d("/admin/base-fertilizers");else throw new Error("No base_fertilizer_id returned")}catch(s){p("เกิดข้อผิดพลาดในการเพิ่มปุ๋ยพื้นฐาน กรุณาลองใหม่"),console.error("Error adding base fertilizer:",s)}finally{u(!1)}}};return e.jsx("div",{children:e.jsxs(c,{children:[e.jsx(c.Header,{children:e.jsx("h5",{children:"เพิ่มปุ๋ยพื้นฐาน"})}),e.jsxs(c.Body,{children:[_&&e.jsx(E,{variant:"danger",children:_}),e.jsxs(r,{onSubmit:b,children:[e.jsxs(y,{children:[e.jsx(l,{md:6,className:"mb-3",children:e.jsxs(r.Group,{controlId:"common_name_th",children:[e.jsx(r.Label,{children:"ชื่อสามัญ (ภาษาไทย)"}),e.jsx(r.Control,{type:"text",name:"common_name_th",value:n.common_name_th,placeholder:"กรอกชื่อสามัญ (ภาษาไทย)",onChange:t,isInvalid:!!a.common_name_th}),e.jsx(r.Control.Feedback,{type:"invalid",children:a.common_name_th})]})}),e.jsx(l,{md:6,className:"mb-3",children:e.jsxs(r.Group,{controlId:"common_name_en",children:[e.jsx(r.Label,{children:"ชื่อสามัญ (ภาษาอังกฤษ)"}),e.jsx(r.Control,{type:"text",name:"common_name_en",value:n.common_name_en,onChange:t,placeholder:"กรอกชื่อสามัญ (ภาษาอังกฤษ)",isInvalid:!!a.common_name_en}),e.jsx(r.Control.Feedback,{type:"invalid",children:a.common_name_en})]})}),e.jsx(l,{md:6,className:"mb-3",children:e.jsxs(r.Group,{controlId:"formula_code",children:[e.jsx(r.Label,{children:"รหัสสูตรปุ๋ย"}),e.jsx(r.Control,{type:"text",name:"formula_code",value:n.formula_code,placeholder:"กรอกรหัสสูตรปุ๋ย",onChange:t,isInvalid:!!a.formula_code}),e.jsx(r.Control.Feedback,{type:"invalid",children:a.formula_code})]})}),e.jsx(l,{md:12,className:"mb-3",children:e.jsxs(r.Group,{controlId:"description",children:[e.jsx(r.Label,{children:"คำอธิบาย"}),e.jsx(r.Control,{as:"textarea",rows:3,name:"description",value:n.description,placeholder:"กรอกคำอธิบาย",onChange:t,isInvalid:!!a.description}),e.jsx(r.Control.Feedback,{type:"invalid",children:a.description})]})})]}),e.jsx(x,{variant:"primary",type:"submit",disabled:m,children:m?"กำลังบันทึก...":"บันทึก"}),e.jsx(x,{variant:"danger",className:"ms-2",onClick:()=>d("/admin/base-fertilizers"),disabled:m,children:"กลับ"})]})]})]})})};export{A as default};
