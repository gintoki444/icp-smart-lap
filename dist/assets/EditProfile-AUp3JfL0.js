import{u as y,r as j,a as N,j as e,R as o,C as r,B as f,D as g,y as b}from"./index-Bq0BSIrC.js";import{F as k,c as L,a as p}from"./formik.esm-BOpZLvMI.js";import{C as c}from"./Card-C7kDYjR9.js";import{F as a}from"./Form-C1nYDdO8.js";function V(){var x;const d=y(),[B,E]=j.useState([]),s=((x=N().state)==null?void 0:x.users)||null;j.useEffect(()=>{s||d("/profile/")},[]);let u={id:s==null?void 0:s.user_id,first_name:s==null?void 0:s.first_name,last_name:s==null?void 0:s.last_name,email:s==null?void 0:s.email,phone:s==null?void 0:s.phone};const _=()=>L({first_name:p().min(3,"ชื่อต้องมีอย่างน้อย 3 ตัวอักษร").required("กรุณากรอกชื่อ"),last_name:p().min(3,"นามสกุลต้องมีอย่างน้อย 3 ตัวอักษร").required("กรุณากรอกนามสกุล"),phone:p().matches(/^[0-9]{10}$/,"กรุณากรอกเบอร์โทรศัพท์ให้ถูกต้อง (10 หลัก)").required("กรุณากรอกเบอร์โทรศัพท์")}),C=async(t,{setErrors:n,setStatus:l,setSubmitting:m})=>{try{delete t.email,await g(t,t.id)&&(b.success("แก้ไขข้อมูลโปรไฟล์สำเร็จ!",{autoClose:3e3}),d("/profile"))}catch(i){console.error(i),b.error(`แก้ไขข้อมูลไม่สำเร็จ: ${i.message}`,{autoClose:3e3}),l({success:!1}),n({submit:i.message}),m(!1)}};return e.jsx(o,{children:e.jsxs(c,{children:[e.jsx(c.Header,{children:e.jsx(o,{children:e.jsx(r,{children:e.jsx(c.Title,{as:"h5",children:"แก้ไขข้อมูลโปรไฟล์"})})})}),e.jsx(c.Body,{children:e.jsx(k,{initialValues:u,validationSchema:_,onSubmit:C,children:({values:t,errors:n,touched:l,handleChange:m,handleBlur:i,handleSubmit:v,isSubmitting:h})=>e.jsxs(a,{onSubmit:v,children:[e.jsxs(o,{children:[e.jsx(r,{md:6,children:e.jsxs(a.Group,{className:"mb-2",children:[e.jsx(a.Label,{children:"ชื่อ:"}),e.jsx(a.Control,{type:"text",className:"form-control",placeholder:"ชื่อ",name:"first_name",value:t.first_name,onChange:m,onBlur:i,isInvalid:l.first_name&&!!n.first_name}),l.first_name&&n.first_name&&e.jsx(a.Control.Feedback,{type:"invalid",children:n.first_name})]})}),e.jsx(r,{md:6,children:e.jsxs(a.Group,{className:"mb-2",children:[e.jsx(a.Label,{children:"นามสกุล :"}),e.jsx(a.Control,{type:"text",className:"form-control",placeholder:"นามสกุล",name:"last_name",value:t.last_name,onChange:m,onBlur:i,isInvalid:l.last_name&&!!n.last_name}),l.last_name&&n.last_name&&e.jsx(a.Control.Feedback,{type:"invalid",children:n.last_name})]})}),e.jsx(r,{md:6,children:e.jsxs(a.Group,{className:"mb-2",children:[e.jsx(a.Label,{children:"อีเมล์ :"}),e.jsx(a.Control,{type:"email",className:"form-control",placeholder:"อีเมล์",name:"email",disabled:!0,value:t.email,onBlur:i,isInvalid:l.email&&!!n.email}),l.email&&n.email&&e.jsx(a.Control.Feedback,{type:"invalid",children:n.email})]})}),e.jsx(r,{md:6,children:e.jsxs(a.Group,{className:"mb-2",children:[e.jsx(a.Label,{children:"เบอร์โทรศัพท์ :"}),e.jsx(a.Control,{type:"text",className:"form-control",placeholder:"ตัวอย่าง: 0812345678",name:"phone",value:t.phone,onChange:m,onBlur:i,isInvalid:l.phone&&!!n.phone}),l.phone&&n.phone&&e.jsx(a.Control.Feedback,{type:"invalid",children:n.phone})]})})]}),e.jsx(o,{className:"mt-3",children:e.jsxs(r,{children:[e.jsx(f,{variant:"primary",type:"submit",disabled:h,children:h?e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"feather icon-save"})," บันทึก"]})}),e.jsxs(f,{variant:"danger",onClick:()=>d("/profile"),className:"ms-2",children:[e.jsx("i",{className:"feather icon-corner-up-left"})," ย้อนกลับ"]})]})})]})})})]})})}export{V as default};
