import{r as o,u as S,h as N,az as k,j as e,R as h,C as v,B as i,i as B,F as z,k as D}from"./index-Bq0BSIrC.js";import{d as R}from"./customerRequest-CvJAP-BQ.js";import{C as c}from"./Card-C7kDYjR9.js";import{S as E}from"./Stack-fH19WBfQ.js";import{F}from"./Form-C1nYDdO8.js";import{B as T}from"./Badge-D-xOYCqC.js";import{B as b}from"./ButtonGroup-bg4r2ah8.js";import{D as I}from"./DataGrid-CHhOcfGb.js";import"./DefaultPropsProvider-CMzRgkCO.js";import"./emotion-element-f0de968e.browser.esm-xSVEHtue.js";import"./TextField-BqqrABCd.js";import"./toPropertyKey-KGmwFxs9.js";import"./Transition-DABJrq3x.js";import"./setPrototypeOf-DgZC2w_0.js";import"./Divider-31lZdKBP.js";const Y=()=>{const[f,x]=o.useState([]),[r,l]=o.useState(()=>localStorage.getItem("filterText")||""),[d,u]=o.useState(f),m=S();o.useEffect(()=>{const t=localStorage.getItem("authToken");t&&N(t).then(s=>{s.user.user_id&&p(s.user.user_id)})},[]),o.useEffect(()=>{},[d]);const p=t=>{k(t).then(s=>{if(s){const n=s.map((a,C)=>({id:a.company_id,No:C+1,company_name:a.company_name,company_code:a.company_code,company_address:a.company_address,document_address:a.document_address,tax_id:a.tax_id,company_email:a.company_email,company_phone:a.company_phone,special_conditions:a.special_conditions,created_at:new Date(a.created_at).toLocaleString(),status:a.status,customer_contacts:a.customer_contacts}));x(n),u(n)}})},g=[{field:"No",headerName:"No.",width:90,headerAlign:"center",align:"center"},{field:"company_name",headerName:"ชื่อบริษัท",flex:1.2},{field:"company_address",headerName:"ที่อยู่บริษัท",flex:1},{field:"company_email",headerName:"อีเมล์",flex:1},{field:"company_phone",headerName:"เบอร์โทรศัพท์",flex:1},{field:"created_at",headerName:"วันที่สร้าง",flex:1},{field:"status",headerName:"สถานะ",width:120,headerAlign:"center",align:"center",renderCell:t=>e.jsx(T,{pill:!0,style:{},bg:t.row.status==="pending"?"warning":t.row.status==="rejected"?"danger":"success",children:t.row.status==="pending"?"รออนุมัติ":t.row.status==="rejected"?"ไม่อนุมัติ":"อนุมัติ"})},{field:"actions",headerName:"การจัดการ",width:200,headerAlign:"center",align:"center",renderCell:t=>e.jsxs(b,{children:[e.jsx(i,{variant:"info",size:"sm",onClick:()=>y(t.row),children:e.jsx(z,{})}),e.jsx(i,{variant:"outline-danger",size:"sm",onClick:()=>w(t.row.id),children:e.jsx(D,{})})]})}],_=d.filter(t=>Object.values(t).some(s=>s&&s.toString().toLowerCase().includes(r.toLowerCase())));o.useEffect(()=>{localStorage.setItem("filterText",r)},[r]);const j=()=>{l(""),localStorage.removeItem("filterText")},y=t=>{m("/company/edit",{state:{company:t}})},w=t=>{if(window.confirm("คุณต้องการลบข้อมูลลูกค้า/บริษัทหรือไม่?"))try{R(t).then(()=>{p()})}catch(n){alert("ลบข้อมูลไม่สำเร็จ:",n)}};return e.jsx(h,{className:"",children:e.jsxs(c,{children:[e.jsx(c.Header,{children:e.jsx(h,{children:e.jsxs(v,{children:[e.jsx(c.Title,{as:"h5",children:"รายการข้อมูลลูกค้า/บริษัท"}),e.jsx("span",{className:"d-block m-t-5",children:"บริษัทที่ผู้ใช้งานดูแล"})]})})}),e.jsxs(c.Body,{children:[e.jsxs(E,{direction:"row",spacing:1,sx:{mb:2},children:[e.jsx(F.Control,{type:"text",placeholder:"Search",value:r,onChange:t=>l(t.target.value)}),e.jsx(i,{variant:"primary",size:"sm",color:"secondary",onClick:j,disabled:!r,children:e.jsx(B,{style:{fontSize:20}})}),e.jsxs(i,{variant:"success",size:"sm",onClick:()=>m("/company/select"),children:[e.jsx("i",{className:"feather icon-plus-circle"}),"เพิ่ม"]})]}),e.jsx("div",{children:e.jsx(I,{rows:_,columns:g,pageSize:5,rowsPerPageOptions:[5,10,20],pagination:!0,disableSelectionOnClick:!0,hideFooterSelectedRowCount:!0,style:{fontSize:16}})})]})]})})};export{Y as default};
