import{r as o,u as S,j as e,B as s,i as C,F as N,w as B}from"./index-6YeC_AS5.js";import{g as v,d as z}from"./baseFertilizersRequest-jsJdYFIk.js";import{C as n}from"./Card-BhOVTKNa.js";import{S as E}from"./Stack-DS5MSRky.js";import{F}from"./Form-CGCyrcfL.js";import{D,B as k}from"./DataGrid-DoczE-38.js";import"./DefaultPropsProvider-2RhE6zQB.js";import"./emotion-element-f0de968e.browser.esm-C-W82wov.js";import"./TextField-DmQ6Lsg1.js";import"./toPropertyKey-CTo9CRTC.js";import"./Transition-rt6HDaS9.js";import"./setPrototypeOf-DgZC2w_0.js";import"./Divider-mvYdwXE_.js";const K=()=>{const[f,h]=o.useState([]),[a,l]=o.useState(()=>localStorage.getItem("filterText")||""),[c,x]=o.useState(f),d=S();o.useEffect(()=>{m()},[]),o.useEffect(()=>{},[c]);const m=()=>{v().then(t=>{if(t){const i=t.map((r,w)=>({id:r.base_fertilizer_id,No:w+1,common_name_th:r.common_name_th,common_name_en:r.common_name_en,formula_code:r.formula_code,description:r.description,created_at:new Date(r.created_at).toLocaleString()}));h(i),x(i)}})},p=[{field:"No",headerName:"No.",width:90,headerAlign:"center",align:"center"},{field:"common_name_th",headerName:"ชื่อแม่ปุ๋ย (TH)",flex:1},{field:"common_name_en",headerName:"ชื่อแม่ปุ๋ย (EN)",flex:1},{field:"description",headerName:"รายละเอียด",flex:1.2},{field:"created_at",headerName:"วันที่สร้าง",flex:.7},{field:"actions",headerName:"Action",width:200,headerAlign:"center",align:"center",renderCell:t=>e.jsxs(k,{children:[e.jsx(s,{variant:"info",size:"sm",onClick:()=>j(t.row.id),children:e.jsx(N,{})}),e.jsx(s,{variant:"outline-danger",size:"sm",onClick:()=>_(t.row.id),children:e.jsx(B,{})})]})}],u=c.filter(t=>Object.values(t).some(i=>i&&i.toString().toLowerCase().includes(a.toLowerCase())));o.useEffect(()=>{localStorage.setItem("filterText",a)},[a]);const g=()=>{l(""),localStorage.removeItem("filterText")},j=t=>{d("/admin/base-fertilizers/edit",{state:{id:t}})},_=t=>{if(window.confirm("คุณต้องการลบข้อมูลแม่ปุ๋ยหรือไม่?"))try{z(t).then(()=>{m()})}catch(r){alert("ลบข้อมูลไม่สำเร็จ:",r)}};return e.jsx("div",{className:"",children:e.jsxs(n,{children:[e.jsx(n.Header,{children:e.jsx("h5",{children:"ข้อมูลแม่ปุ๋ย"})}),e.jsxs(n.Body,{className:"p-10",children:[e.jsxs(E,{direction:"row",spacing:1,sx:{mb:2},children:[e.jsx(F.Control,{type:"text",placeholder:"Search",value:a,onChange:t=>l(t.target.value)}),e.jsx(s,{variant:"primary",size:"sm",color:"secondary",onClick:g,disabled:!a,children:e.jsx(C,{style:{fontSize:20}})}),e.jsxs(s,{variant:"success",size:"sm",onClick:()=>d("/admin/base-fertilizers/add"),children:[e.jsx("i",{className:"feather icon-plus-circle"}),"เพิ่ม"]})]}),e.jsx(D,{rows:u,columns:p,pageSize:5,rowsPerPageOptions:[5,10,20],pagination:!0,disableSelectionOnClick:!0,hideFooterSelectedRowCount:!0})]})]})})};export{K as default};
