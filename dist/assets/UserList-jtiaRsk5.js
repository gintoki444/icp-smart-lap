import{r as i,u as _,j as e,C as o,B as n,F as S}from"./index-BFZlI6dJ.js";import{S as C,I as v,D as E,R}from"./index-Dq98LQ6f.js";import{g as A,d as D}from"./usersRequest-B_t_Kvx7.js";import{F}from"./Form-FiLb8d9P.js";import{B as k}from"./ButtonGroup-hJfKEDo9.js";import"./emotion-react.browser.esm-CmYPGmvE.js";import"./Transition-BAn3rOC0.js";import"./ElementChildren-CPU8LvB5.js";import"./Col-CY34EU4-.js";const $=()=>{const[f,h]=i.useState([]),[s,l]=i.useState(()=>localStorage.getItem("filterText")||""),[d,x]=i.useState(f),c=_();i.useEffect(()=>{m()},[]),i.useEffect(()=>{},[d]);const m=()=>{A().then(a=>{if(a){const r=a.map((t,N)=>({id:t.user_id,No:N+1,first_name:t.first_name,last_name:t.last_name,fullName:`${t.first_name} ${t.last_name}`,email:t.email,phone:t.phone,role_id:t.role_id,role_name:t.role_name,dept_id:t.dept_id,dept_name:t.dept_name,createdAt:new Date(t.created_at).toLocaleString(),status:t.status}));h(r),x(r)}})},p=[{field:"No",headerName:"No.",width:90,headerAlign:"center",align:"center"},{field:"fullName",headerName:"ชื่อ-นามสกุล",flex:1},{field:"email",headerName:"E-mail",flex:1},{field:"phone",headerName:"เบอร์โทรศัพท์",flex:1},{field:"role_name",headerName:"Roles",width:120,headerAlign:"center",align:"center"},{field:"createdAt",headerName:"วันที่สร้าง",flex:1},{field:"status",headerName:"สถานะ",width:120,headerAlign:"center",align:"center"},{field:"actions",headerName:"การจัดการ",width:200,headerAlign:"center",align:"center",renderCell:a=>e.jsxs(k,{children:[e.jsx(n,{variant:"info",size:"sm",onClick:()=>j(a.row),children:e.jsx(S,{})}),e.jsx(n,{variant:"outline-danger",size:"sm",onClick:()=>w(a.row.id),children:e.jsx(R,{})})]})}],g=d.filter(a=>Object.values(a).some(r=>r&&r.toString().toLowerCase().includes(s.toLowerCase())));i.useEffect(()=>{localStorage.setItem("filterText",s)},[s]);const u=()=>{l(""),localStorage.removeItem("filterText")},j=a=>{c("/admin/user/edit",{state:{users:a}})},w=a=>{if(window.confirm(`คุณต้องการลบข้อมูลผู้ใช้หมายเลข ${a} หรือไม่?`))try{D(a).then(()=>{m()})}catch(t){alert("ลบข้อมูลไม่สำเร็จ:",t)}};return e.jsx("div",{className:"",children:e.jsxs(o,{children:[e.jsx(o.Header,{children:e.jsx("h5",{children:"ข้อมูลรายการตัวอย่าง"})}),e.jsxs(o.Body,{className:"p-10",children:[e.jsxs(C,{direction:"row",spacing:1,sx:{mb:2},children:[e.jsx(F.Control,{type:"text",placeholder:"Search",value:s,onChange:a=>l(a.target.value)}),e.jsx(n,{variant:"primary",size:"sm",color:"secondary",onClick:u,disabled:!s,children:e.jsx(v,{style:{fontSize:20}})}),e.jsxs(n,{variant:"success",size:"sm",onClick:()=>c("/admin/user/add"),children:[e.jsx("i",{className:"feather icon-plus-circle"}),"เพิ่ม"]})]}),e.jsx(E,{rows:g,columns:p,pageSize:5,rowsPerPageOptions:[5,10,20],pagination:!0,disableSelectionOnClick:!0,hideFooterSelectedRowCount:!0})]})]})})};export{$ as default};
