import{d as I,r as y,o as L,j as e,R as d,C as t,F as i,B as _,y as h}from"./index-BnqE3Rwp.js";import{F as G,c as B,a as u}from"./formik.esm-CDJOjLuD.js";import{g as E,a as K}from"./menusRequest-BjcwLE2f.js";import{C as m}from"./Card-BpOPiakr.js";function $(){var x;const r=I(),[b,v]=y.useState([]),n=((x=L().state)==null?void 0:x.menus)||null;y.useEffect(()=>{n||r("/admin/menus/"),f()},[]);const f=()=>{E().then(l=>{l&&v(l)})},k={id:n==null?void 0:n.id,menu_name:n==null?void 0:n.menu_name,menu_key:n==null?void 0:n.menu_key,menu_type:n==null?void 0:n.menu_type,parent_id:n==null?void 0:n.parent_id,route:n==null?void 0:n.route,icon:n==null?void 0:n.icon,sort_order:n==null?void 0:n.sort_order},C=()=>B({menu_name:u().min(3,'"ชื่อ" ต้องมีอย่างน้อย 3 ตัวอักษร').required("กรุณากรอกชื่อ"),menu_key:u().min(3,'"Key" ต้องมีอย่างน้อย 3 ตัวอักษร').required("กรุณากรอก Key"),menu_type:u().required("กรุณาเลือก Type")}),g=async(l,{setErrors:a,setStatus:s,setSubmitting:o})=>{try{console.log(l);const c=await K(l,l.id);console.log(c),c.message==="อัปเดตเมนูสำเร็จ"&&(h.success("แก้ไขข้อมูลเมนูสำเร็จ!",{autoClose:3e3}),r("/admin/menus/"))}catch(c){h.error(`แก้ไขข้อมูลไม่สำเร็จ: ${c.message}`,{autoClose:3e3}),s({success:!1}),a({submit:c.message}),o(!1)}};return e.jsx(d,{children:e.jsxs(m,{children:[e.jsx(m.Header,{children:e.jsx(d,{children:e.jsx(t,{children:e.jsx(m.Title,{as:"h5",children:"แก้ไขข้อมูลเมนู"})})})}),e.jsx(m.Body,{children:e.jsx(G,{initialValues:k,validationSchema:C,onSubmit:g,children:({values:l,errors:a,touched:s,handleChange:o,handleBlur:c,handleSubmit:N,isSubmitting:j})=>e.jsxs(i,{onSubmit:N,children:[e.jsxs(d,{children:[e.jsx(t,{md:6,children:e.jsxs(i.Group,{className:"mb-2",children:[e.jsx(i.Label,{children:"ชื่อเมนู:"}),e.jsx(i.Control,{type:"text",className:"form-control",placeholder:"ชื่อเมนู",name:"menu_name",value:l.menu_name,onChange:o,onBlur:c,isInvalid:s.menu_name&&!!a.menu_name}),s.menu_name&&a.menu_name&&e.jsx(i.Control.Feedback,{type:"invalid",children:a.menu_name})]})}),e.jsx(t,{md:6,children:e.jsxs(i.Group,{className:"mb-2",children:[e.jsx(i.Label,{children:"Key :"}),e.jsx(i.Control,{type:"text",className:"form-control",placeholder:"Key",name:"menu_key",value:l.menu_key,onChange:o,onBlur:c,isInvalid:s.menu_key&&!!a.menu_key}),s.menu_key&&a.menu_key&&e.jsx(i.Control.Feedback,{type:"invalid",children:a.menu_key})]})}),e.jsx(t,{md:6,children:e.jsxs(i.Group,{className:"mb-2",children:[e.jsx(i.Label,{children:"Type:"}),e.jsxs(i.Select,{name:"menu_type",style:{padding:"10px 20px"},value:l.menu_type,onChange:o,onBlur:c,isInvalid:s.menu_type&&!!a.menu_type,children:[e.jsx("option",{children:"เลือก Type"}),e.jsx("option",{value:"group",children:"group"}),e.jsx("option",{value:"collapse",children:"collapse"}),e.jsx("option",{value:"item",children:"item"})]}),s.menu_type&&a.menu_type&&e.jsx(i.Control.Feedback,{type:"invalid",children:a.menu_type})]})}),e.jsx(t,{md:6,children:e.jsxs(i.Group,{className:"mb-2",children:[e.jsx(i.Label,{children:"Parent เมนู:"}),e.jsxs(i.Select,{name:"parent_id",style:{padding:"10px 20px"},value:l.parent_id,onChange:o,onBlur:c,isInvalid:s.parent_id&&!!a.parent_id,children:[e.jsx("option",{value:"",children:"เลือก Parent เมนู"}),b.map(p=>e.jsx("option",{value:p.menu_id,children:p.menu_name},p.menu_id))]}),s.parent_id&&a.parent_id&&e.jsx(i.Control.Feedback,{type:"invalid",children:a.parent_id})]})}),e.jsx(t,{md:6,children:e.jsxs(i.Group,{className:"mb-2",children:[e.jsx(i.Label,{children:"Route :"}),e.jsx(i.Control,{type:"text",className:"form-control",placeholder:"/route",name:"route",value:l.route,onChange:o,onBlur:c,isInvalid:s.route&&!!a.route}),s.route&&a.route&&e.jsx(i.Control.Feedback,{type:"invalid",children:a.route})]})}),e.jsx(t,{md:6,children:e.jsxs(i.Group,{className:"mb-2",children:[e.jsx(i.Label,{children:"Icon :"}),e.jsx(i.Control,{type:"text",className:"form-control",placeholder:"Icon",name:"icon",value:l.icon,onChange:o,onBlur:c,isInvalid:s.icon&&!!a.icon}),s.icon&&a.icon&&e.jsx(i.Control.Feedback,{type:"invalid",children:a.icon})]})})]}),e.jsx(d,{className:"mt-3",children:e.jsxs(t,{children:[e.jsx(_,{variant:"primary",type:"submit",disabled:j,children:j?e.jsx("span",{className:"spinner-border spinner-border-sm me-2",menu:"status","aria-hidden":"true"}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"feather icon-save"})," บันทึก"]})}),e.jsxs(_,{variant:"danger",onClick:()=>r("/admin/menus"),className:"ms-2",children:[e.jsx("i",{className:"feather icon-corner-up-left"})," ย้อนกลับ"]})]})})]})})})]})})}export{$ as default};
