import{r as s,u as w,j as e,F as C,B as r,m as y,n as S,o as v}from"./index-DZpC_pHZ.js";import{g as D,d as E}from"./customerRequest-CwUVzGH7.js";import{C as n}from"./Card-ZCMDsCmS.js";import{S as R}from"./Stack-BiqWndJ2.js";import{B as k}from"./ButtonGroup-DLGnQ8T-.js";import{D as z}from"./DataGrid-DlzfhZq7.js";import"./DefaultPropsProvider-LyYhFUFs.js";import"./toPropertyKey-COtC2h-V.js";import"./Transition-DW97tWQD.js";import"./Divider-BV326Lun.js";const H=()=>{const[f,h]=s.useState([]),[i,d]=s.useState(()=>localStorage.getItem("filterText")||""),[l,x]=s.useState(f),c=w();s.useEffect(()=>{m()},[]),s.useEffect(()=>{},[l]);const m=()=>{D().then(a=>{if(a){const o=a.map((t,N)=>({id:t.company_id,No:N+1,company_name:t.company_name,company_code:t.company_code,company_address:t.company_address,document_address:t.document_address,tax_id:t.tax_id,email:t.email,phone:t.phone,special_conditions:t.special_conditions,created_at:new Date(t.created_at).toLocaleString()}));h(o),x(o)}})},p=[{field:"No",headerName:"No.",width:90,headerAlign:"center",align:"center"},{field:"company_code",headerName:"รหัสบริษัท",flex:.7},{field:"company_name",headerName:"ชื่อบริษัท",flex:1.2},{field:"tax_id",headerName:"เลขที่ผู้เสียภาษี",flex:1},{field:"company_address",headerName:"ที่อยู่บริษัท",flex:1},{field:"document_address",headerName:"ที่อยู่จัดส่งเอกสาร",flex:1},{field:"email",headerName:"อีเมล์",flex:1},{field:"phone",headerName:"เบอร์โทรศัพท์",flex:1},{field:"special_conditions",headerName:"Roles",flex:.7},{field:"created_at",headerName:"วันที่สร้าง",flex:1},{field:"actions",headerName:"การจัดการ",width:200,headerAlign:"center",align:"center",renderCell:a=>e.jsxs(k,{children:[e.jsx(r,{variant:"info",size:"sm",onClick:()=>_(a.row),children:e.jsx(S,{})}),e.jsx(r,{variant:"outline-danger",size:"sm",onClick:()=>j(a.row.id),children:e.jsx(v,{})})]})}],u=l.filter(a=>Object.values(a).some(o=>o&&o.toString().toLowerCase().includes(i.toLowerCase())));s.useEffect(()=>{localStorage.setItem("filterText",i)},[i]);const g=()=>{d(""),localStorage.removeItem("filterText")},_=a=>{c("/admin/customer/edit",{state:{customers:a}})},j=a=>{if(window.confirm("คุณต้องการลบข้อมูลบริษัทหรือไม่?"))try{E(a).then(()=>{m()})}catch(t){alert("ลบข้อมูลไม่สำเร็จ:",t)}};return e.jsx("div",{className:"",children:e.jsxs(n,{children:[e.jsx(n.Header,{children:e.jsx("h5",{children:"ข้อมูลบริษัท"})}),e.jsxs(n.Body,{className:"p-10",children:[e.jsxs(R,{direction:"row",spacing:1,sx:{mb:2},children:[e.jsx(C.Control,{type:"text",placeholder:"Search",value:i,onChange:a=>d(a.target.value)}),e.jsx(r,{variant:"primary",size:"sm",color:"secondary",onClick:g,disabled:!i,children:e.jsx(y,{style:{fontSize:20}})}),e.jsxs(r,{variant:"success",size:"sm",onClick:()=>c("/admin/customer/add"),children:[e.jsx("i",{className:"feather icon-plus-circle"}),"เพิ่ม"]})]}),e.jsx(z,{rows:u,columns:p,pageSize:5,rowsPerPageOptions:[5,10,20],pagination:!0,disableSelectionOnClick:!0,hideFooterSelectedRowCount:!0})]})]})})};export{H as default};
