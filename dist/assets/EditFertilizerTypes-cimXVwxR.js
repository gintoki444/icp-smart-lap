import{u as v,a as C,r as i,j as e,R as E,C as F,B as h,y as S}from"./index-CMKGjvil.js";import{a as w,b as B}from"./fertilizerTypesRequest-CzftO6V-.js";import{C as m}from"./Card-ltuRbL1m.js";import{A as D}from"./Alert-CaEs9ZRl.js";import{F as s}from"./Form-XAT3KesX.js";import"./CloseButton-DXA2z1Sn.js";import"./Transition-CvY6YelV.js";import"./setPrototypeOf-DgZC2w_0.js";const O=()=>{var u;const o=v(),a=((u=C().state)==null?void 0:u.id)||null,[n,p]=i.useState({fertilizer_type_name:""}),[l,x]=i.useState({}),[f,c]=i.useState(null),[d,y]=i.useState(!1);i.useEffect(()=>{a?j():o("/admin/fertilizers-types")},[a]);const _=()=>{const r={};return n.fertilizer_type_name.trim()||(r.fertilizer_type_name="กรุณากรอกชื่อลักษณะปุ๋ย"),Object.keys(r).length===0},j=async()=>{try{const r=await w(a);p({fertilizer_type_name:r.fertilizer_type_name||""})}catch(r){c("เกิดข้อผิดพลาดในการดึงข้อมูลปุ๋ยพื้นฐาน"),console.error("Error fetching base fertilizer:",r)}},z=r=>{const{name:t,value:b}=r.target;p({...n,[t]:b}),x({...l,[t]:""})},g=async r=>{if(r.preventDefault(),!!_()){y(!0),c(null);try{const t=await B(a,n);S.success("แก้ไขลักษณะปุ๋ยสำเร็จ!",{autoClose:3e3}),o("/admin/fertilizer-types")}catch(t){c("เกิดข้อผิดพลาดในการแก้ไขลักษณะปุ๋ย กรุณาลองใหม่"),console.error("Error adding base fertilizer:",t)}finally{y(!1)}}};return e.jsx("div",{children:e.jsxs(m,{children:[e.jsx(m.Header,{children:e.jsx("h5",{children:"แก้ไขลักษณะปุ๋ย"})}),e.jsxs(m.Body,{children:[f&&e.jsx(D,{variant:"danger",children:f}),e.jsxs(s,{onSubmit:g,children:[e.jsx(E,{children:e.jsx(F,{md:6,className:"mb-3",children:e.jsxs(s.Group,{controlId:"fertilizer_type_name",children:[e.jsx(s.Label,{children:"ชื่อลักษณะปุ๋ย"}),e.jsx(s.Control,{type:"text",name:"fertilizer_type_name",value:n.fertilizer_type_name,placeholder:"กรอกลักษณะปุ๋ย",onChange:z,isInvalid:!!l.fertilizer_type_name}),e.jsx(s.Control.Feedback,{type:"invalid",children:l.fertilizer_type_name})]})})}),e.jsx(h,{variant:"primary",type:"submit",disabled:d,children:d?"กำลังบันทึก...":"บันทึก"}),e.jsx(h,{variant:"danger",className:"ms-2",onClick:()=>o("/admin/fertilizer-types"),disabled:d,children:"กลับ"})]})]})]})})};export{O as default};
