import{u as V,a as W,r as c,j as e,R as r,C as t,B as _,F as Y}from"./index-6YeC_AS5.js";import{b as O}from"./quotationRequest-BTgCnPa-.js";import{C as o}from"./Card-BhOVTKNa.js";import{F as s}from"./Form-CGCyrcfL.js";import{T as $}from"./Table-WM_kTK7U.js";const X=()=>{const u=V(),j=W(),[a,k]=c.useState(null),[d,C]=c.useState({}),[v,S]=c.useState([]),[h,p]=c.useState(0),[b,N]=c.useState("percentage"),[w,F]=c.useState(""),[q,D]=c.useState(""),[T,L]=c.useState(""),[G,I]=c.useState("");c.useEffect(()=>{var y;const n=((y=j.state)==null?void 0:y.id)||null;n?(async()=>{try{const l=await O(n);k(l);const x=l.customer_info[0]||{};C({company_code:x.company_code||"-",company_name:x.company_name||"-",tax_id:x.tax_id||"-",company_address:x.company_address||"-",customer_special_conditions:x.special_conditions?[{description:x.special_conditions}]:[]});const R=l.quotation_details.map(m=>({id:m.quotation_detail_id,name:m.name_for_quotation,testCode:m.test_code,price:parseFloat(m.unit_price),quantity:m.quantity,summary:parseFloat(m.total_price)}));S(R),parseFloat(l.discount_percentage)>0?(N("percentage"),p(parseFloat(l.discount_percentage))):parseFloat(l.discount_amount)>0&&(N("amount"),p(parseFloat(l.discount_amount))),F(new Date(l.quotation_date).toISOString().split("T")[0]),D(l.payment_terms||"30 วัน"),L(new Date(l.valid_until).toISOString().split("T")[0]),I(l.quotation_type_name||"")}catch(g){console.error("Error fetching quotation details:",g)}})():(console.error("Quotation ID not provided"),u("/admin/issue-quotation"))},[j.search,u]);const i=n=>n.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),Q=a?parseFloat(a.total_amount):0,B=a?parseFloat(a.discount_amount):0,E=a?parseFloat(a.net_total):0,U=a?parseFloat(a.vat_amount):0,A=a?parseFloat(a.grand_total):0,H=n=>{u("/admin/issue-quotation/edit",{state:{id:n}})};return e.jsx(e.Fragment,{children:e.jsx(r,{children:e.jsxs(o,{children:[e.jsx(o.Header,{children:e.jsx(r,{children:e.jsx(t,{children:e.jsxs(o.Title,{as:"h5",children:["รายละเอียดใบเสนอราคา (เลขที่: ",e.jsx("strong",{children:(a==null?void 0:a.quotation_no)||"-"}),")"]})})})}),e.jsxs(o.Body,{children:[e.jsx(o,{className:"mb-3",children:e.jsx(o.Body,{className:"pt-3 pb-2",children:e.jsxs(r,{children:[e.jsx(t,{md:12,children:e.jsx("h6",{className:"mb-3",children:"ข้อมูลลูกค้า/บริษัท"})}),e.jsx(t,{md:6,className:"mb-2",children:e.jsxs(s.Group,{as:r,className:"align-items-center",children:[e.jsx(s.Label,{column:!0,xs:4,className:"text-dark",children:"รหัสลูกค้า:"}),e.jsx(t,{xs:8,children:e.jsx(s.Control,{type:"text",value:d.company_code||"-",disabled:!0,style:{backgroundColor:"#f8f9fa"}})})]})}),e.jsx(t,{md:6,className:"mb-2",children:e.jsxs(s.Group,{as:r,className:"align-items-center",children:[e.jsx(s.Label,{column:!0,xs:4,className:"text-dark",children:"ชื่อบริษัท:"}),e.jsx(t,{xs:8,children:e.jsx(s.Control,{type:"text",value:d.company_name||"-",disabled:!0,style:{backgroundColor:"#f8f9fa"}})})]})}),e.jsx(t,{md:6,className:"mb-2",children:e.jsxs(s.Group,{as:r,className:"align-items-center",children:[e.jsx(s.Label,{column:!0,xs:4,className:"text-dark",children:"เลขที่ผู้เสียภาษี:"}),e.jsx(t,{xs:8,children:e.jsx(s.Control,{type:"text",value:d.tax_id||"-",disabled:!0,style:{backgroundColor:"#f8f9fa"}})})]})}),e.jsx(t,{md:6,className:"mb-2",children:e.jsxs(s.Group,{as:r,className:"align-items-center",children:[e.jsx(s.Label,{column:!0,xs:4,className:"text-dark",children:"ที่อยู่:"}),e.jsx(t,{xs:8,children:e.jsx(s.Control,{type:"text",value:d.company_address||"-",disabled:!0,style:{backgroundColor:"#f8f9fa"}})})]})}),e.jsx(t,{md:6,className:"mb-2",children:e.jsxs(s.Group,{as:r,className:"align-items-center",children:[e.jsx(s.Label,{column:!0,xs:4,className:"text-dark",children:"เงื่อนไขพิเศษ:"}),e.jsx(t,{xs:8,children:e.jsx(s.Control,{type:"text",value:d.customer_special_conditions&&d.customer_special_conditions.length>0?d.customer_special_conditions.map(n=>n.description).join(", "):"-",disabled:!0,style:{backgroundColor:"#f8f9fa"}})})]})}),e.jsx(t,{md:6,className:"mb-2",children:e.jsxs(s.Group,{as:r,className:"align-items-center",children:[e.jsx(s.Label,{column:!0,xs:4,className:"text-dark",children:"วันที่เอกสาร:"}),e.jsx(t,{xs:8,children:e.jsx(s.Control,{type:"date",value:w,disabled:!0,style:{backgroundColor:"#f8f9fa"}})})]})}),e.jsx(t,{md:6,className:"mb-2",children:e.jsxs(s.Group,{as:r,className:"align-items-center",children:[e.jsx(s.Label,{column:!0,xs:4,className:"text-dark",children:"เงื่อนไขการชำระเงิน:"}),e.jsx(t,{xs:8,children:e.jsx(s.Control,{type:"text",value:q,disabled:!0,style:{backgroundColor:"#f8f9fa"}})})]})}),e.jsx(t,{md:6,className:"mb-2",children:e.jsxs(s.Group,{as:r,className:"align-items-center",children:[e.jsx(s.Label,{column:!0,xs:4,className:"text-dark",children:"ใช้ได้ถึงวันที่:"}),e.jsx(t,{xs:8,children:e.jsx(s.Control,{type:"date",value:T,disabled:!0,style:{backgroundColor:"#f8f9fa"}})})]})})]})})}),e.jsx(o,{className:"mb-0",children:e.jsxs(o.Body,{className:"pt-3 pb-2",children:[e.jsx(r,{children:e.jsx(t,{className:"ps-3 pe-3 mb-3",children:e.jsxs(s.Group,{as:r,className:"align-items-center",children:[e.jsx(s.Label,{column:!0,xs:2,className:"text-dark",children:"ประเภทใบเสนอราคา:"}),e.jsx(t,{xs:10,children:e.jsx(s.Control,{type:"text",value:G,disabled:!0,style:{backgroundColor:"#f8f9fa"}})})]})})}),e.jsxs($,{striped:!0,bordered:!0,hover:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{width:80,className:"text-center",children:"No."}),e.jsx("th",{children:"ชื่อตัวอย่าง"}),e.jsx("th",{className:"text-center",children:"Code"}),e.jsx("th",{width:120,className:"text-center",children:"จำนวน"}),e.jsx("th",{width:150,className:"text-center",children:"ราคาต่อหน่วย"}),e.jsx("th",{width:150,className:"text-end",children:"รวม"})]})}),e.jsxs("tbody",{children:[v.map((n,f)=>e.jsxs("tr",{children:[e.jsx("td",{className:"text-center",style:{whiteSpace:"normal",wordWrap:"break-word",maxHeight:"100px",overflowY:"auto"},children:f+1}),e.jsx("td",{style:{whiteSpace:"normal",wordWrap:"break-word",maxHeight:"100px",overflowY:"auto"},children:n.name}),e.jsx("td",{className:"text-center",style:{whiteSpace:"normal",wordWrap:"break-word",maxHeight:"100px",overflowY:"auto"},children:n.testCode}),e.jsx("td",{className:"text-center",children:e.jsx(s.Control,{type:"number",value:n.quantity,disabled:!0,style:{width:"100px",margin:"auto",backgroundColor:"#f8f9fa"}})}),e.jsx("td",{className:"text-center",children:e.jsx(s.Control,{type:"number",value:n.price,disabled:!0,style:{width:"100px",margin:"auto",backgroundColor:"#f8f9fa"}})}),e.jsx("td",{className:"text-end",children:i(n.summary)})]},n.id)),(a==null?void 0:a.quotation_type_id)===3&&e.jsxs("tr",{children:[e.jsx("td",{colSpan:4,className:"text-end",children:"ส่วนลด"}),e.jsx("td",{className:"text-center",children:e.jsx(s.Control,{type:"number",value:h,disabled:!0,style:{width:"100px",margin:"auto",backgroundColor:"#f8f9fa"}})}),e.jsx("td",{children:e.jsxs(s.Select,{value:b,disabled:!0,style:{width:"100px",margin:"auto",backgroundColor:"#f8f9fa"},children:[e.jsx("option",{value:"percentage",children:"%"}),e.jsx("option",{value:"amount",children:"บาท"})]})})]}),e.jsxs("tr",{children:[e.jsx("td",{colSpan:5,className:"text-end",children:e.jsx("p",{className:"mb-0 text-dark",children:"ราคารวมก่อนส่วนลด:"})}),e.jsx("td",{className:"text-end",children:e.jsxs("p",{className:"mb-0 text-dark",children:[i(Q)," บาท"]})})]}),e.jsxs("tr",{children:[e.jsx("td",{colSpan:5,className:"text-end",children:e.jsxs("p",{className:"mb-0 text-dark",children:["ส่วนลด (",b==="percentage"?`${h}%`:`${i(h)} บาท`,"):"]})}),e.jsx("td",{className:"text-end",children:e.jsxs("p",{className:"mb-0 text-dark",children:[i(B)," บาท"]})})]}),e.jsxs("tr",{children:[e.jsx("td",{colSpan:5,className:"text-end",children:e.jsx("p",{className:"mb-0 text-dark",children:"ราคาสุทธิ :"})}),e.jsx("td",{className:"text-end",children:e.jsxs("p",{className:"mb-0 text-dark",children:[i(E)," บาท"]})})]}),e.jsxs("tr",{children:[e.jsx("td",{colSpan:5,className:"text-end",children:e.jsx("p",{className:"mb-2 text-dark",children:"VAT 7%:"})}),e.jsx("td",{className:"text-end",children:e.jsxs("p",{className:"mb-2 text-dark",children:[i(U)," บาท"]})})]}),e.jsxs("tr",{children:[e.jsx("td",{colSpan:5,className:"text-end",children:e.jsx("h6",{className:"mb-0",children:"ยอดรวมทั้งหมด :"})}),e.jsx("td",{className:"text-end",children:e.jsxs("h6",{children:[i(A)," บาท"]})})]})]})]})]})})]}),e.jsxs(o.Footer,{children:[e.jsxs(_,{variant:"primary",onClick:()=>H(a.quotation_id),children:[e.jsx(Y,{style:{marginRight:8}})," แก้ไขข้อมูล"]}),e.jsxs(_,{variant:"danger",onClick:()=>u("/admin/issue-quotation"),children:[e.jsx("i",{className:"feather icon-corner-up-left"})," กลับ"]})]})]})})})};export{X as default};
