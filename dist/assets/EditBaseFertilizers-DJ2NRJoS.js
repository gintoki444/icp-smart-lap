import{u as F,a as E,r as t,j as e,R as z,C as c,B as b,y as I}from"./index-6YeC_AS5.js";import{a as B,b as k}from"./baseFertilizersRequest-jsJdYFIk.js";import{C as _}from"./Card-BhOVTKNa.js";import{A as L}from"./Alert-D32VqIXN.js";import{F as n}from"./Form-CGCyrcfL.js";import"./CloseButton-BYF_v0Zl.js";import"./Transition-rt6HDaS9.js";import"./setPrototypeOf-DgZC2w_0.js";const q=()=>{var j;const l=F(),s=((j=E().state)==null?void 0:j.id)||null,[r,u]=t.useState({common_name_th:"",common_name_en:"",formula_code:"",description:""}),[a,p]=t.useState({}),[x,d]=t.useState(null),[h,f]=t.useState(!1);t.useEffect(()=>{s?v():l("/admin/base-fertilizers")},[s]);const v=async()=>{try{const o=await B(s);u({common_name_th:o.common_name_th||"",common_name_en:o.common_name_en||"",formula_code:o.formula_code||"",description:o.description||""})}catch(o){d("เกิดข้อผิดพลาดในการดึงข้อมูลปุ๋ยพื้นฐาน"),console.error("Error fetching base fertilizer:",o)}},C=()=>{const o={};return r.common_name_th.trim()||(o.common_name_th="กรุณากรอกชื่อสามัญ (ภาษาไทย)"),r.common_name_en.trim()||(o.common_name_en="กรุณากรอกชื่อสามัญ (ภาษาอังกฤษ)"),r.formula_code.trim()||(o.formula_code="กรุณากรอกรหัสสูตรปุ๋ย"),r.description.trim()||(o.description="กรุณากรอกคำอธิบาย"),p(o),Object.keys(o).length===0},i=o=>{const{name:m,value:g}=o.target;u({...r,[m]:g}),p({...a,[m]:""})},y=async o=>{if(o.preventDefault(),!!C()){f(!0),d(null);try{await k(s,r),I.success("แก้ไขปุ๋ยพื้นฐานสำเร็จ!",{autoClose:3e3}),l("/admin/base-fertilizers")}catch(m){d("เกิดข้อผิดพลาดในการแก้ไขปุ๋ยพื้นฐาน กรุณาลองใหม่"),console.error("Error updating base fertilizer:",m)}finally{f(!1)}}};return e.jsx("div",{children:e.jsxs(_,{children:[e.jsx(_.Header,{children:e.jsx("h5",{children:"แก้ไขปุ๋ยพื้นฐาน"})}),e.jsxs(_.Body,{children:[x&&e.jsx(L,{variant:"danger",children:x}),e.jsxs(n,{onSubmit:y,children:[e.jsxs(z,{children:[e.jsx(c,{md:6,className:"mb-3",children:e.jsxs(n.Group,{controlId:"common_name_th",children:[e.jsx(n.Label,{children:"ชื่อสามัญ (ภาษาไทย)"}),e.jsx(n.Control,{type:"text",name:"common_name_th",value:r.common_name_th,placeholder:"กรอกชื่อสามัญ (ภาษาไทย)",onChange:i,isInvalid:!!a.common_name_th}),e.jsx(n.Control.Feedback,{type:"invalid",children:a.common_name_th})]})}),e.jsx(c,{md:6,className:"mb-3",children:e.jsxs(n.Group,{controlId:"common_name_en",children:[e.jsx(n.Label,{children:"ชื่อสามัญ (ภาษาอังกฤษ)"}),e.jsx(n.Control,{type:"text",name:"common_name_en",value:r.common_name_en,onChange:i,placeholder:"กรอกชื่อสามัญ (ภาษาอังกฤษ)",isInvalid:!!a.common_name_en}),e.jsx(n.Control.Feedback,{type:"invalid",children:a.common_name_en})]})}),e.jsx(c,{md:6,className:"mb-3",children:e.jsxs(n.Group,{controlId:"formula_code",children:[e.jsx(n.Label,{children:"รหัสสูตรปุ๋ย"}),e.jsx(n.Control,{type:"text",name:"formula_code",value:r.formula_code,placeholder:"กรอกรหัสสูตรปุ๋ย",onChange:i,isInvalid:!!a.formula_code}),e.jsx(n.Control.Feedback,{type:"invalid",children:a.formula_code})]})}),e.jsx(c,{md:12,className:"mb-3",children:e.jsxs(n.Group,{controlId:"description",children:[e.jsx(n.Label,{children:"คำอธิบาย"}),e.jsx(n.Control,{as:"textarea",rows:3,name:"description",value:r.description,placeholder:"กรอกคำอธิบาย",onChange:i,isInvalid:!!a.description}),e.jsx(n.Control.Feedback,{type:"invalid",children:a.description})]})})]}),e.jsx(b,{variant:"primary",type:"submit",disabled:h,children:h?"กำลังบันทึก...":"บันทึก"}),e.jsx(b,{variant:"danger",className:"ms-2",onClick:()=>l("/admin/base-fertilizers"),disabled:h,children:"กลับ"})]})]})]})})};export{q as default};
