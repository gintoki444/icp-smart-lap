import{r as i,u as v,j as t,B as a,i as S,o as N,F as k,k as E,y as h}from"./index-Bq0BSIrC.js";import{g as R,d as F}from"./menusRequest-Bj_jsQPR.js";import{C as s}from"./Card-C7kDYjR9.js";import{S as B}from"./Stack-fH19WBfQ.js";import{F as I}from"./Form-C1nYDdO8.js";import{B as T}from"./ButtonGroup-bg4r2ah8.js";import{D as L}from"./DataGrid-CHhOcfGb.js";import"./DefaultPropsProvider-CMzRgkCO.js";import"./emotion-element-f0de968e.browser.esm-xSVEHtue.js";import"./TextField-BqqrABCd.js";import"./toPropertyKey-KGmwFxs9.js";import"./Transition-DABJrq3x.js";import"./setPrototypeOf-DgZC2w_0.js";import"./Divider-31lZdKBP.js";const W=()=>{const[l,p]=i.useState([]),[n,d]=i.useState(()=>localStorage.getItem("filterText")||""),[c,x]=i.useState(l),[M,m]=i.useState(!0),u=v();i.useEffect(()=>{f()},[]),i.useEffect(()=>{},[c]);const f=()=>{m(!0),R().then(e=>{if(e){const r=e.map((o,C)=>({id:o.menu_id,no:C+1,menu_name:o.menu_name,menu_key:o.menu_key,menu_type:o.menu_type,parent_id:o.parent_id,route:o.route,icon:o.icon,sort_order:o.sort_order,is_active:o.is_active}));p(r),x(r)}m(!1)})},g=[{field:"no",headerName:"No.",width:90,headerAlign:"center",align:"center"},{field:"menu_name",headerName:"ชื่อเมนู",flex:1},{field:"menu_key",headerName:"key",flex:1},{field:"menu_type",headerName:"Type",flex:1},{field:"parent_id",headerName:"Parent menu",flex:1,renderCell:e=>{const r=l.find(o=>o.id===e.row.parent_id);return r?r.menu_name:"-"}},{field:"route",headerName:"Route",flex:1},{field:"icon",headerName:"Icon",flex:1,renderCell:e=>e.row.icon?t.jsx(N,{items:{icon:e.row.icon,title:e.row.menu_name}}):"-"},{field:"actions",headerName:"การจัดการ",width:200,headerAlign:"center",align:"center",renderCell:e=>t.jsxs(T,{children:[t.jsx(a,{variant:"info",size:"sm",onClick:()=>_(e.row),children:t.jsx(k,{})}),t.jsx(a,{variant:"outline-danger",size:"sm",onClick:()=>y(e.row.id),children:t.jsx(E,{})})]})}],w=c.filter(e=>Object.values(e).some(r=>r&&r.toString().toLowerCase().includes(n.toLowerCase())));i.useEffect(()=>{localStorage.setItem("filterText",n)},[n]);const j=()=>{d(""),localStorage.removeItem("filterText")},_=e=>{u("/admin/menus/edit",{state:{menus:e}})},y=async e=>{if(window.confirm("Are you sure you want to delete this device?"))try{await F(e),h.success("ลบข้อมูลสำเร็จ!"),f()}catch(r){h.error("เกิดข้อผิดพลาด!:"+r),console.error("Error deleting device:",r)}};return t.jsx("div",{className:"",children:t.jsxs(s,{children:[t.jsx(s.Header,{children:t.jsx("h5",{children:"ข้อมูลรายการเมนู"})}),t.jsxs(s.Body,{className:"p-10",children:[t.jsxs(B,{direction:"row",spacing:1,sx:{mb:2},children:[t.jsx(I.Control,{type:"text",placeholder:"Search",value:n,onChange:e=>d(e.target.value)}),t.jsx(a,{variant:"primary",color:"secondary",onClick:j,disabled:!n,children:t.jsx(S,{style:{fontSize:20}})}),t.jsxs(a,{variant:"success",onClick:()=>u("/admin/menus/add"),children:[t.jsx("i",{className:"feather icon-plus-circle"}),"เพิ่ม"]})]}),t.jsx(L,{rows:w,columns:g,pageSize:5,rowsPerPageOptions:[5,10,20],pagination:!0,disableSelectionOnClick:!0,hideFooterSelectedRowCount:!0})]})]})})};export{W as default};
