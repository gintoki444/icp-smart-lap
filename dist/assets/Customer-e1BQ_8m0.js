import{r as i,u as N,j as e,B as r,i as C,F as y,w as S}from"./index-6YeC_AS5.js";import{g as v,d as D}from"./customerRequest-D-QXhSQD.js";import{C as n}from"./Card-BhOVTKNa.js";import{S as E}from"./Stack-DS5MSRky.js";import{F}from"./Form-CGCyrcfL.js";import{D as R,B as k}from"./DataGrid-DoczE-38.js";import"./DefaultPropsProvider-2RhE6zQB.js";import"./emotion-element-f0de968e.browser.esm-C-W82wov.js";import"./TextField-DmQ6Lsg1.js";import"./toPropertyKey-CTo9CRTC.js";import"./Transition-rt6HDaS9.js";import"./setPrototypeOf-DgZC2w_0.js";import"./Divider-mvYdwXE_.js";const K=()=>{const[f,p]=i.useState([]),[s,d]=i.useState(()=>localStorage.getItem("filterText")||""),[l,h]=i.useState(f),c=N();i.useEffect(()=>{m()},[]),i.useEffect(()=>{},[l]);const m=()=>{v().then(t=>{if(t){const o=t.map((a,w)=>({id:a.company_id,No:w+1,company_name:a.company_name,company_code:a.company_code,company_address:a.company_address,document_address:a.document_address,tax_id:a.tax_id,email:a.email,phone:a.phone,special_conditions:a.special_conditions,created_at:new Date(a.created_at).toLocaleString(),customer_contacts:a["customer-contacts"]}));p(o),h(o)}})},x=[{field:"No",headerName:"No.",width:90,headerAlign:"center",align:"center"},{field:"company_code",headerName:"รหัสบริษัท",flex:.7},{field:"company_name",headerName:"ชื่อบริษัท",flex:1.2},{field:"tax_id",headerName:"เลขที่ผู้เสียภาษี",flex:1},{field:"company_address",headerName:"ที่อยู่บริษัท",flex:1},{field:"document_address",headerName:"ที่อยู่จัดส่งเอกสาร",flex:1},{field:"email",headerName:"อีเมล์",flex:1},{field:"phone",headerName:"เบอร์โทรศัพท์",flex:1},{field:"special_conditions",headerName:"Roles",flex:.7},{field:"created_at",headerName:"วันที่สร้าง",flex:1},{field:"actions",headerName:"Action",width:200,headerAlign:"center",align:"center",renderCell:t=>e.jsxs(k,{children:[e.jsx(r,{variant:"info",size:"sm",onClick:()=>g(t.row),children:e.jsx(y,{})}),e.jsx(r,{variant:"outline-danger",size:"sm",onClick:()=>j(t.row.id),children:e.jsx(S,{})})]})}],u=l.filter(t=>Object.values(t).some(o=>o&&o.toString().toLowerCase().includes(s.toLowerCase())));i.useEffect(()=>{localStorage.setItem("filterText",s)},[s]);const _=()=>{d(""),localStorage.removeItem("filterText")},g=t=>{c("/admin/customer/edit",{state:{customers:t}})},j=t=>{if(window.confirm("คุณต้องการลบข้อมูลลูกค้า/บริษัทหรือไม่?"))try{D(t).then(()=>{m()})}catch(a){alert("ลบข้อมูลไม่สำเร็จ:",a)}};return e.jsx("div",{className:"",children:e.jsxs(n,{children:[e.jsx(n.Header,{children:e.jsx("h5",{children:"ข้อมูลลูกค้า/บริษัท"})}),e.jsxs(n.Body,{className:"p-10",children:[e.jsxs(E,{direction:"row",spacing:1,sx:{mb:2},children:[e.jsx(F.Control,{type:"text",placeholder:"Search",value:s,onChange:t=>d(t.target.value)}),e.jsx(r,{variant:"primary",size:"sm",color:"secondary",onClick:_,disabled:!s,children:e.jsx(C,{style:{fontSize:20}})}),e.jsxs(r,{variant:"success",size:"sm",onClick:()=>c("/admin/customer/add"),children:[e.jsx("i",{className:"feather icon-plus-circle"}),"เพิ่ม"]})]}),e.jsx(R,{rows:u,columns:x,pageSize:5,rowsPerPageOptions:[5,10,20],pagination:!0,disableSelectionOnClick:!0,hideFooterSelectedRowCount:!0})]})]})})};export{K as default};
