import{u as I,r as _,a as L,j as e,R as r,C as t,B as y,y as h}from"./index-6YeC_AS5.js";import{F as G,c as B,a as x}from"./formik.esm-C0GtiMNK.js";import{g as E,a as K}from"./menusRequest-Bj_jsQPR.js";import{C as d}from"./Card-BhOVTKNa.js";import{F as n}from"./Form-CGCyrcfL.js";function w(){var u;const m=I(),[b,v]=_.useState([]),i=((u=L().state)==null?void 0:u.menus)||null;_.useEffect(()=>{i||m("/admin/menus/"),f()},[]);const f=()=>{E().then(l=>{l&&v(l)})},C={id:i==null?void 0:i.id,menu_name:i==null?void 0:i.menu_name,menu_key:i==null?void 0:i.menu_key,menu_type:i==null?void 0:i.menu_type,parent_id:i==null?void 0:i.parent_id,route:i==null?void 0:i.route,icon:i==null?void 0:i.icon,sort_order:i==null?void 0:i.sort_order},k=()=>B({menu_name:x().min(3,'"ชื่อ" ต้องมีอย่างน้อย 3 ตัวอักษร').required("กรุณากรอกชื่อ"),menu_key:x().min(3,'"Key" ต้องมีอย่างน้อย 3 ตัวอักษร').required("กรุณากรอก Key"),menu_type:x().required("กรุณาเลือก Type")}),N=async(l,{setErrors:s,setStatus:a,setSubmitting:c})=>{try{console.log(l);const o=await K(l,l.id);console.log(o),o.message==="อัปเดตเมนูสำเร็จ"&&(h.success("แก้ไขข้อมูลเมนูสำเร็จ!",{autoClose:3e3}),m("/admin/menus/"))}catch(o){h.error(`แก้ไขข้อมูลไม่สำเร็จ: ${o.message}`,{autoClose:3e3}),a({success:!1}),s({submit:o.message}),c(!1)}};return e.jsx(r,{children:e.jsxs(d,{children:[e.jsx(d.Header,{children:e.jsx(r,{children:e.jsx(t,{children:e.jsx(d.Title,{as:"h5",children:"แก้ไขข้อมูลเมนู"})})})}),e.jsx(d.Body,{children:e.jsx(G,{initialValues:C,validationSchema:k,onSubmit:N,children:({values:l,errors:s,touched:a,handleChange:c,handleBlur:o,handleSubmit:g,isSubmitting:j})=>e.jsxs(n,{onSubmit:g,children:[e.jsxs(r,{children:[e.jsx(t,{md:6,children:e.jsxs(n.Group,{className:"mb-2",children:[e.jsx(n.Label,{children:"ชื่อเมนู:"}),e.jsx(n.Control,{type:"text",className:"form-control",placeholder:"ชื่อเมนู",name:"menu_name",value:l.menu_name,onChange:c,onBlur:o,isInvalid:a.menu_name&&!!s.menu_name}),a.menu_name&&s.menu_name&&e.jsx(n.Control.Feedback,{type:"invalid",children:s.menu_name})]})}),e.jsx(t,{md:6,children:e.jsxs(n.Group,{className:"mb-2",children:[e.jsx(n.Label,{children:"Key :"}),e.jsx(n.Control,{type:"text",className:"form-control",placeholder:"Key",name:"menu_key",value:l.menu_key,onChange:c,onBlur:o,isInvalid:a.menu_key&&!!s.menu_key}),a.menu_key&&s.menu_key&&e.jsx(n.Control.Feedback,{type:"invalid",children:s.menu_key})]})}),e.jsx(t,{md:6,children:e.jsxs(n.Group,{className:"mb-2",children:[e.jsx(n.Label,{children:"Type:"}),e.jsxs(n.Select,{name:"menu_type",style:{padding:"10px 20px"},value:l.menu_type,onChange:c,onBlur:o,isInvalid:a.menu_type&&!!s.menu_type,children:[e.jsx("option",{children:"เลือก Type"}),e.jsx("option",{value:"group",children:"group"}),e.jsx("option",{value:"collapse",children:"collapse"}),e.jsx("option",{value:"item",children:"item"})]}),a.menu_type&&s.menu_type&&e.jsx(n.Control.Feedback,{type:"invalid",children:s.menu_type})]})}),e.jsx(t,{md:6,children:e.jsxs(n.Group,{className:"mb-2",children:[e.jsx(n.Label,{children:"Parent เมนู:"}),e.jsxs(n.Select,{name:"parent_id",style:{padding:"10px 20px"},value:l.parent_id,onChange:c,onBlur:o,isInvalid:a.parent_id&&!!s.parent_id,children:[e.jsx("option",{value:"",children:"เลือก Parent เมนู"}),b.map(p=>e.jsx("option",{value:p.menu_id,children:p.menu_name},p.menu_id))]}),a.parent_id&&s.parent_id&&e.jsx(n.Control.Feedback,{type:"invalid",children:s.parent_id})]})}),e.jsx(t,{md:6,children:e.jsxs(n.Group,{className:"mb-2",children:[e.jsx(n.Label,{children:"Route :"}),e.jsx(n.Control,{type:"text",className:"form-control",placeholder:"/route",name:"route",value:l.route,onChange:c,onBlur:o,isInvalid:a.route&&!!s.route}),a.route&&s.route&&e.jsx(n.Control.Feedback,{type:"invalid",children:s.route})]})}),e.jsx(t,{md:6,children:e.jsxs(n.Group,{className:"mb-2",children:[e.jsx(n.Label,{children:"Icon :"}),e.jsx(n.Control,{type:"text",className:"form-control",placeholder:"Icon",name:"icon",value:l.icon,onChange:c,onBlur:o,isInvalid:a.icon&&!!s.icon}),a.icon&&s.icon&&e.jsx(n.Control.Feedback,{type:"invalid",children:s.icon})]})}),e.jsx(t,{md:6,children:e.jsxs(n.Group,{className:"mb-2",children:[e.jsx(n.Label,{children:"ลำดับเมนู:"}),e.jsx(n.Control,{type:"text",className:"form-control",placeholder:"ชื่อเมนู",name:"sort_order",value:l.sort_order,onChange:c,onBlur:o,isInvalid:a.sort_order&&!!s.sort_order}),a.sort_order&&s.sort_order&&e.jsx(n.Control.Feedback,{type:"invalid",children:s.sort_order})]})})]}),e.jsx(r,{className:"mt-3",children:e.jsxs(t,{children:[e.jsx(y,{variant:"primary",type:"submit",disabled:j,children:j?e.jsx("span",{className:"spinner-border spinner-border-sm me-2",menu:"status","aria-hidden":"true"}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"feather icon-save"})," บันทึก"]})}),e.jsxs(y,{variant:"danger",onClick:()=>m("/admin/menus"),className:"ms-2",children:[e.jsx("i",{className:"feather icon-corner-up-left"})," ย้อนกลับ"]})]})})]})})})]})})}export{w as default};
