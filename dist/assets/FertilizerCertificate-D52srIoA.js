import{r as a,u as v,j as e,B as o,i as C,F as S,v as F}from"./index-CMKGjvil.js";import{g as N,d as z}from"./fertilizerCertificateRequest-DsyareGj.js";import{C as s}from"./Card-ltuRbL1m.js";import{S as D}from"./Stack-_RiFjssk.js";import{F as E}from"./Form-XAT3KesX.js";import{D as k,B as y}from"./DataGrid-BSrFaLwh.js";import"./DefaultPropsProvider-7CXMMYWk.js";import"./emotion-element-f0de968e.browser.esm-D2ySOhvj.js";import"./TextField-l4tn0KBj.js";import"./toPropertyKey-BZFHAmHd.js";import"./Transition-CvY6YelV.js";import"./setPrototypeOf-DgZC2w_0.js";import"./Divider-Rbts8ePN.js";const K=()=>{const[f,h]=a.useState([]),[n,l]=a.useState(()=>localStorage.getItem("filterText")||""),[c,u]=a.useState(f),d=v();a.useEffect(()=>{m()},[]),a.useEffect(()=>{},[c]);const m=()=>{N().then(t=>{if(t){const r=t.map((i,_)=>({id:i.standard_id,No:_+1,fertilizer_main_id:i.fertilizer_main_id,nutrient_name:i.nutrient_name,min_value:i.min_value,unit:i.unit,legal_reference:i.legal_reference,created_at:new Date(i.created_at).toLocaleString()}));h(r),u(r)}})},x=[{field:"No",headerName:"No.",width:90,headerAlign:"center",align:"center"},{field:"nutrient_name",headerName:"ชื่อมาตรฐานการรับรองปุ๋ย",flex:1},{field:"min_value",headerName:"ค่ามาตราฐาน (หน่วย)",flex:.7,headerAlign:"right",align:"right",renderCell:t=>e.jsxs(e.Fragment,{children:[" ",t.row.min_value?t.row.min_value+" "+t.row.unit:"-"]})},{field:"legal_reference",headerName:"อ้างอิงทางกฎหมาย",flex:1},{field:"actions",headerName:"Action",width:200,headerAlign:"center",align:"center",renderCell:t=>e.jsxs(y,{children:[e.jsx(o,{variant:"info",size:"sm",onClick:()=>j(t.row.id),children:e.jsx(S,{})}),e.jsx(o,{variant:"outline-danger",size:"sm",onClick:()=>w(t.row.id),children:e.jsx(F,{})})]})}],g=c.filter(t=>Object.values(t).some(r=>r&&r.toString().toLowerCase().includes(n.toLowerCase())));a.useEffect(()=>{localStorage.setItem("filterText",n)},[n]);const p=()=>{l(""),localStorage.removeItem("filterText")},j=t=>{d("/admin/fertilizer-certificate/edit",{state:{id:t}})},w=t=>{if(window.confirm("คุณต้องการลบข้อมูลมาตรฐานการรับรองปุ๋ยหรือไม่?"))try{z(t).then(()=>{m()})}catch(i){alert("ลบข้อมูลไม่สำเร็จ:",i)}};return e.jsx("div",{className:"",children:e.jsxs(s,{children:[e.jsx(s.Header,{children:e.jsx("h5",{children:"ข้อมูลมาตรฐานการรับรองปุ๋ย"})}),e.jsxs(s.Body,{className:"p-10",children:[e.jsxs(D,{direction:"row",spacing:1,sx:{mb:2},children:[e.jsx(E.Control,{type:"text",placeholder:"Search",value:n,onChange:t=>l(t.target.value)}),e.jsx(o,{variant:"primary",size:"sm",color:"secondary",onClick:p,disabled:!n,children:e.jsx(C,{style:{fontSize:20}})}),e.jsxs(o,{variant:"success",size:"sm",onClick:()=>d("/admin/fertilizer-certificate/add"),children:[e.jsx("i",{className:"feather icon-plus-circle"}),"เพิ่ม"]})]}),e.jsx(k,{rows:g,columns:x,pageSize:5,rowsPerPageOptions:[5,10,20],pagination:!0,disableSelectionOnClick:!0,hideFooterSelectedRowCount:!0})]})]})})};export{K as default};
