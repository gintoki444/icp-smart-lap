import{r as w,u as $,g as b,s as h,d as E}from"./firebaseConfig-pMHECxRz.js";const j=async(t,s,m)=>{if(!t)throw new Error("❌ ไม่พบไฟล์สำหรับอัปโหลด");if(Array.isArray(t)||(t=[t]),t.length===0)throw new Error("❌ ไม่พบไฟล์สำหรับอัปโหลด");const u=e=>new Promise(i=>{if(!e.type.startsWith("image/")||e.type==="image/jpeg"||e.type==="image/jpg")i(e);else{const a=new Image,n=new FileReader;n.onload=g=>{a.src=g.target.result,a.onload=()=>{const o=document.createElement("canvas");o.width=a.width,o.height=a.height,o.getContext("2d").drawImage(a,0,0),o.toBlob(l=>{const d=new File([l],e.name,{type:"image/jpeg",lastModified:Date.now()});i(d)},"image/jpeg",.9)}},n.readAsDataURL(e)}}),y=t.map(async(e,i)=>new Promise(async(a,n)=>{const g=Date.now();let o=e,c="";e.type.startsWith("image/")?(o=await u(e),c=".jpg"):c=e.name.substring(e.name.lastIndexOf("."));const l=t.length>1?`${m}_${g}_${i}${c}`:`${m}_${g}${c}`,d=`uploads/${s}/${l}`,F=w(h,d),p=$(F,o);p.on("state_changed",r=>{},r=>{console.error("❌ Error uploading file:",r),n(r)},async()=>{try{const r=await b(p.snapshot.ref);a({fileName:d,url:r})}catch(r){n(r)}})}));return await Promise.all(y)},D=async t=>{if(!t)throw new Error("❌ ไม่พบเส้นทางไฟล์สำหรับลบ");try{const s=w(h,t);await E(s),console.log(`✅ Deleted file from Firebase: ${t}`)}catch(s){throw console.error("❌ Error deleting file from Firebase:",s),s}};export{D as d,j as h};
