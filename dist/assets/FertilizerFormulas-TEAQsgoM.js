import{r as a,u as z,j as t,B as n,i as N,F as C,k as S}from"./index-Bq0BSIrC.js";import{g as b,d as v}from"./fertilizerFormulasRequest-CtobAFDH.js";import{C as o}from"./Card-C7kDYjR9.js";import{S as E}from"./Stack-fH19WBfQ.js";import{F as k}from"./Form-C1nYDdO8.js";import{B as D}from"./ButtonGroup-bg4r2ah8.js";import{D as F}from"./DataGrid-CHhOcfGb.js";import"./DefaultPropsProvider-CMzRgkCO.js";import"./emotion-element-f0de968e.browser.esm-xSVEHtue.js";import"./TextField-BqqrABCd.js";import"./toPropertyKey-KGmwFxs9.js";import"./Transition-DABJrq3x.js";import"./setPrototypeOf-DgZC2w_0.js";import"./Divider-31lZdKBP.js";const M=()=>{const[f,_]=a.useState([]),[s,l]=a.useState(()=>localStorage.getItem("filterText")||""),[d,h]=a.useState(f),m=z();a.useEffect(()=>{c()},[]),a.useEffect(()=>{},[d]);const c=()=>{b().then(e=>{if(e){const i=e.map((r,w)=>({id:r.formula_id,No:w+1,formula_name:r.formula_name,formula_code:r.formula_code,base_fertilizer_id:r.base_fertilizer_id,formula_description:r.formula_description,nutrient_ratio:r.nutrient_ratio,is_rice_fertilizer:r.is_rice_fertilizer,recommended_tests:r.recommended_tests,base_fertilizer_name_th:r.base_fertilizer_name_th,base_fertilizer_name_en:r.base_fertilizer_name_en,fertilizer_main_name_th:r.fertilizer_main_name_th,fertilizer_main_name_en:r.fertilizer_main_name_en,created_at:new Date(r.created_at).toLocaleString()}));_(i),h(i)}})},x=[{field:"No",headerName:"No.",width:90,headerAlign:"center",align:"center"},{field:"formula_name",headerName:"ชื่อสูตร",flex:1},{field:"formula_code",headerName:"สูตร",flex:1},{field:"formula_description",headerName:"รายละเอียด",flex:1},{field:"nutrient_ratio",headerName:"อัตราส่วนสารอาหาร",flex:1},{field:"recommended_tests",headerName:"การทดสอบที่แนะนำ",flex:1},{field:"base_fertilizer_name_th",headerName:"ชื่อปุ๋ยพื้นฐาน (TH)",flex:1,renderCell:e=>e.row.base_fertilizer_name_th||"-"},{field:"base_fertilizer_name_en",headerName:"ชื่อปุ๋ยพื้นฐาน (EN)",flex:1,renderCell:e=>e.row.base_fertilizer_name_en||"-"},{field:"fertilizer_main_name_th",headerName:"ประเภทปุ๋ย",flex:1},{field:"actions",headerName:"Action",width:200,headerAlign:"center",align:"center",renderCell:e=>t.jsxs(D,{children:[t.jsx(n,{variant:"info",size:"sm",onClick:()=>g(e.row.id),children:t.jsx(C,{})}),t.jsx(n,{variant:"outline-danger",size:"sm",onClick:()=>j(e.row.id),children:t.jsx(S,{})})]})}],u=d.filter(e=>Object.values(e).some(i=>i&&i.toString().toLowerCase().includes(s.toLowerCase())));a.useEffect(()=>{localStorage.setItem("filterText",s)},[s]);const p=()=>{l(""),localStorage.removeItem("filterText")},g=e=>{m("/admin/fertilizer-formulas/edit",{state:{id:e}})},j=e=>{if(window.confirm("คุณต้องการลบข้อมูลสูตรปุ๋ยหรือไม่?"))try{v(e).then(()=>{c()})}catch(r){alert("ลบข้อมูลไม่สำเร็จ:",r)}};return t.jsx("div",{className:"",children:t.jsxs(o,{children:[t.jsx(o.Header,{children:t.jsx("h5",{children:"ข้อมูลสูตรปุ๋ย"})}),t.jsxs(o.Body,{className:"p-10",children:[t.jsxs(E,{direction:"row",spacing:1,sx:{mb:2},children:[t.jsx(k.Control,{type:"text",placeholder:"Search",value:s,onChange:e=>l(e.target.value)}),t.jsx(n,{variant:"primary",size:"sm",color:"secondary",onClick:p,disabled:!s,children:t.jsx(N,{style:{fontSize:20}})}),t.jsxs(n,{variant:"success",size:"sm",onClick:()=>m("/admin/fertilizer-formulas/add"),children:[t.jsx("i",{className:"feather icon-plus-circle"}),"เพิ่ม"]})]}),t.jsx(F,{rows:u,columns:x,pageSize:5,rowsPerPageOptions:[5,10,20],pagination:!0,disableSelectionOnClick:!0,hideFooterSelectedRowCount:!0})]})]})})};export{M as default};
